# オセロAI パラメータ一覧

実装時に参照するパラメータの完全なリスト

---

## 1. パターン定義

| 項目 | 値 | 備考 |
|------|-----|------|
| パターン数 | 14 | P01-P14（詳細は`patterns.csv`参照） |
| 総エントリ数 | 約14,434,000 | 全パターン・全ステージの合計 |
| ステージ数 | 30 | 2手ごとに分割（0-1手, 2-3手, ..., 58-59手） |

---

## 2. スコア表現

| 項目 | 値 | 説明 |
|------|-----|------|
| データ型 | `u16` | 0-65535 |
| スケール係数 | 256.0 | 石差の倍率 |
| 中央値 | 32768 | 石差0に対応 |
| 石差範囲 | -128.0 ~ +127.996 | |
| 変換式（u16→石差） | `(value - 32768) / 256` | |
| 変換式（石差→u16） | `clamp(score × 256 + 32768, 0, 65535)` | |

---

## 3. TD(λ)-Leaf学習

| 項目 | 値 | 説明 |
|------|-----|------|
| λ | 0.3 | Eligibility Trace減衰率 |
| 更新頻度 | 1局終了ごと | 逆順に全手を更新 |
| 学習目標 | 100万局 | 約33.6億回の更新 |

---

## 4. Adamオプティマイザ

| 項目 | 値 | 説明 |
|------|-----|------|
| 学習率 α | 0.025 | 基本学習率 |
| β1 | 0.9 | 1次モーメント減衰率 |
| β2 | 0.999 | 2次モーメント減衰率 |
| ε | 1e-8 | 数値安定性のための小さな値 |

---

## 5. MTD(f)探索

| 項目 | 値 | 説明 |
|------|-----|------|
| 探索方式 | MTD(f) + 反復深化 | |
| 時間制限 | 15ms/手 | 学習時 |
| 初期推定値 | 現在の評価値 | MTD(f)の初期guess |
| 完全読み開始 | 残り14手 | 約16,384局面 |

---

## 6. 置換表

| 項目 | 値 | 説明 |
|------|-----|------|
| サイズ | 128-256 MB | 環境に応じて調整可能 |
| エントリ数 | 約200-400万 | |
| ハッシュ方式 | Zobrist Hashing | |
| 置換戦略 | 深さ優先 + 世代管理 | |

---

## 7. Move Ordering優先度

| 優先順位 | 手の種類 | スコア調整 |
|---------|---------|----------|
| 1 | 置換表の最善手 | -10000 |
| 2 | 角（A1,H1,A8,H8） | -1000 |
| 3 | 辺（角以外） | -100 |
| 4 | X打ち（角の隣） | +500（避ける） |
| 5 | その他 | 0 |

---

## 8. 自己対戦（ε-greedy）

| 局数範囲 | ε値 | 説明 |
|---------|------|------|
| 0 - 30万局 | 0.15 | 探索的（15%ランダム） |
| 30 - 70万局 | 0.05 | バランス（5%ランダム） |
| 70 - 100万局 | 0.0 | 完全最善手 |

---

## 9. 対称性

| 項目 | 値 | 説明 |
|------|-----|------|
| 考慮する変換 | 回転のみ（4方向） | 0°, 90°, 180°, 270° |
| 反転 | 考慮しない | 回転でカバー可能 |
| テーブル共有 | 0°のみ保持 | |
| 0°/180° | 同じテーブル | そのまま使用 |
| 90°/270° | 0°テーブル + 白黒反転 | index(黒, 白) → index(白, 黒) |

---

## 10. 初期値

| 項目 | 値 | 説明 |
|------|-----|------|
| パターンテーブル | 32768（全エントリ） | 石差0 |
| Adam 1次モーメント | 0.0（全エントリ） | |
| Adam 2次モーメント | 0.0（全エントリ） | |
| タイムステップ | 0 | |

---

## 11. チェックポイント

| 項目 | 値 | 説明 |
|------|-----|------|
| 保存頻度 | 10万局ごと | 合計10回 |
| ファイル名形式 | `checkpoint_NNNNNN.bin` | NNNNNNは局数（0埋め6桁） |
| 保存内容 | テーブル + Adam状態 + メタデータ | |

---

## 12. ログ・監視

| 頻度 | 記録内容 |
|------|---------|
| 100局ごと | 平均石差、黒勝率、白勝率、引分率、平均手数、経過時間 |
| 1万局ごと | 評価値統計（平均、標準偏差、最大/最小）、平均探索深さ、平均探索時間、置換表ヒット率 |
| チェックポイント時 | 完全な統計サマリ、進捗レポート |

---

## 13. メモリ使用量

| 項目 | サイズ | 詳細 |
|------|--------|------|
| パターンテーブル | 57 MB | 14パターン × 30ステージ × u16 |
| Adam 1次モーメント | 114 MB | 同サイズ × f32 |
| Adam 2次モーメント | 114 MB | 同サイズ × f32 |
| 置換表 | 128-256 MB | 設定可能 |
| **合計** | **413-541 MB** | |

---

## 14. ハードウェア環境

| 項目 | 値 |
|------|-----|
| プラットフォーム | Oracle Cloud Infrastructure (OCI) Always Free |
| インスタンス | Ampere A1 |
| CPU | 4 OCPU (ARM64) |
| メモリ | 24 GB |
| 月間制限 | 3,000 OCPU時間、18,000 GB時間 |

---

## 15. 学習時間見積もり

| 項目 | 値 | 備考 |
|------|-----|------|
| 総局数 | 100万局 | |
| 総手数 | 約6,000万手 | 平均60手/局 |
| 探索時間/手 | 15ms（平均） | 実効は10-12ms |
| 並列度 | 4コア | |
| 理論時間 | 62.5時間 | 6000万 × 15ms ÷ 4 |
| 実効時間 | 50-60時間 | 約2.5日 |
| 月間使用率 | 約8% | 60時間 / 720時間 |

---

## 16. BitBoard定数

| 項目 | 値 |
|------|-----|
| 初期黒石 | `0x0000001010000000` | D4, E5 |
| 初期白石 | `0x0000001008000000` | E4, D5 |
| 角マスク | `0x8100000000000081` | A1, H1, A8, H8 |
| 辺マスク | `0xFF818181818181FF` | 全辺 |

---

## 17. 探索定数

| 項目 | 値 | 説明 |
|------|-----|------|
| 無限大 | 100000 | AlphaBeta用 |
| 勝ちスコア | 6400 | 石差64 × 100 |
| パススコア | 評価値継承 | そのまま次の探索へ |

---

## 18. Zobrist Hashing

| 項目 | 値 | 説明 |
|------|-----|------|
| シード | 123456789 | 再現性のための固定シード |
| テーブルサイズ | 黒64 + 白64 + 手番1 | 計129個の64bit乱数 |

---

## 19. ファイルパス（例）

| 用途 | パス |
|------|------|
| パターン定義 | `data/patterns.csv` |
| チェックポイント | `checkpoints/checkpoint_NNNNNN.bin` |
| ログ | `logs/training_YYYYMMDD_HHMMSS.log` |
| 最終モデル | `models/final_model.bin` |

---

## 20. Python連携

| 項目 | 値 |
|------|-----|
| ライブラリ | PyO3 |
| モジュール名 | `othello_ai` |
| 主要クラス | `PyEvaluator` |
| 主要メソッド | `evaluate()`, `train_game()`, `save()`, `load()` |

---

## 21. コンパイルオプション

```toml
[profile.release]
opt-level = 3          # 最大最適化
lto = "fat"            # Link Time Optimization
codegen-units = 1      # 単一コード生成ユニット
panic = "abort"        # パニック時即座に終了
```

---

## 22. 評価関数計算式

```
評価値 = Σ(i=0..55) u16_to_score(table[pattern_id(i)][stage][index(i)])

手番が白なら符号反転
```

---

## 23. TD更新式

```
td_error = target - current_value

target = 
  - 最終手: final_score
  - それ以外: λ × final_score + (1-λ) × next_value

gradient = td_error × eligibility_trace
```

---

## 24. パフォーマンス目標

| 指標 | 目標値 |
|------|--------|
| 探索速度 | 15ms/手以内 |
| メモリ使用 | 600MB以内 |
| 平均更新/エントリ | 200回以上 |
| ランダムに対する勝率 | 99%以上 |

---

このパラメータ一覧を参照することで、実装時の値を素早く確認できます。
